# What is the MAAP custom form

The purpose of the custom form is to take a MAAP parameter and input file, allow the user to edit the various parts of the form, then re-generate the form with the new changes. The information is then used somewhere in the application and is tied to doclink variables in some way.

## What Parses the MAAP files

When a user creates a custom application of type 'MAAP', the first thing the software does is have them upload a MAAP parameter file and MAAP input file. There are two parsers, one for parsing input files, and one for parsing parameter files. With the file -- as a string -- for input, The parser will then generate a large object containing all of the data from the file. The parsers are autogenerated using a tool called [PEGGY](https://peggyjs.org/). Peggy is an online tool that generates a parser based off of 'peggy' grammar written by the user. To view the peggy grammar used to generate the parser that parses the parameter file, look at 'grammar-par.pegjs' in the ./CustomForms/MAAP/Parser directory. The grammar for input parser is in grammar.pegjs. The actual parsers - one for parameter files and one for input files - are in files maap-inp-parser.ts and maap-par-parser.ts respectively. Most of the file is unreadable, and should only be edited by editing the peggy grammar and regenerating the parser. But at the end of the parser files, there is an export section. They export a "parse" function that we can call from our components.

When calling the parse function, you will see code that looks like this "const data = InputParse(fileString, {});" The second parameter is just there because typescript wants there to be a second parameter included in the call. But it is an optional parameter in the javascript parser. After the parser finishes parsing the file, it returns an object with all of the information from the file. From there, the object is iterated through and saved into different sections so that it can easily be accessed from the various components of making a custom action.

## Sections of a MAAP file as stored from the parser

Right after the file is uploaded, we iterate through it and various parts of the file are stored together. In a MAAP input file, we begin with the title and the corresponding parameter file. We then have a section for parameter variables, aliases, initiators, conditional blocks, print interval, time settings, and plotfile output. Each of those sections are stored in the variable "formData" in the action. Then, when rendering the different sections to the screen, we can grab the section we want to display from formData and output it. When the user changes any of the information, we update the formData property. For example,when the Parameter component is rendered, it grabs the property "parameters" from the formData property.
